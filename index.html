<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Assets & Harms</title>
  <script type="module" src="https://js.arcgis.com/calcite-components/3.3.0/calcite.esm.js"></script>
</head>

<body>


  <!-- DIALOGS    -->
  <calcite-dialog open modal heading="Community Assets and Harms Mapping Tool" id="info-dialog">
    <div>
      <h2>Oregon Community Assets & Harms</h2>
      <p><strong>A Mapping Tool</strong></p>

      <p>
        The Community Assets & Harms Mapping Tool is intended for use by planners across the state of Oregon in
        identifying patterns of environmental conditions – both beneficial and harmful –
        in their respective communities in a user-friendly fashion. Investigating these patterns is one step among many
        in considering where to focus various local actions.
        .
      </p>

      <p>
        The data sources behind each indicator in this tool come from a variety of sources with differing update
        schedules, and, like all data, have imperfections inherent in them.
        The results of this mapping tool alone should not result in any decision-making or regulatory effect. They are
        intended for planning purposes only.
        The mapping tool uses large datasets and functions best on a desktop device with a strong internet connection.

      </p>

      <p>
        For more information email
        <a href="mailto:housing.dlcd@dlcd.oregon.gov?subject=Harms%20and%20Assets%20Tool">
          housing.dlcd@dlcd.oregon.gov
        </a>  
      </p>
    </div>
  </calcite-dialog>



  <calcite-dialog id="guide-dialog" heading="Community Assets and Harms User Guide" modal>
    <div>
      <h2>User Guide</h2>

      <p><strong>Scoring</strong></p>
      <p>
        Each indicator is scored <strong>relative to the selected Comparison Region</strong> (UGB, Region, or State).
        This means a value can change depending on what it is being compared against.
        For example, a hex in Portland may have a Childcare score of 0.34 when compared to all other hexes in Portland
        (UGB), but a childcare score of 0.84 when compared to all other hexes in the State.
      </p>
      <p>
        Because all scores are relative, changing the Comparison Region can significantly shift results. Reviewing
        scores with multiple comparison regions can provide important context.
      </p>
      <p>
        The final Harms and Assets scores represent the <strong>average</strong> of the relative scores across all
        selected Harms or Assets.
      </p>
    </div>
  </calcite-dialog>


  <calcite-shell>
    <!-- HEADER WITH LOGO -->
    <calcite-navigation slot="header">
      <calcite-navigation-logo slot="logo" heading="Community Assets & Harms Mapping Tool"
        thumbnail="https://raw.githubusercontent.com/DLCDOfficial/dlcd-logos/refs/heads/main/DLCD_logo_only.png"></calcite-navigation-logo>
    </calcite-navigation>

    <!-- SIDE PANEL CONTROLS -->
    <calcite-shell-panel slot="panel-start" position="start" id="shell-panel-start">
      <calcite-action-bar slot="action-bar" expanded>
        <calcite-action-group>
          <calcite-action active text="Configure" icon="configure" text-enabled></calcite-action>
        </calcite-action-group>
        <calcite-action-group slot="bottom-actions">
          <calcite-action id="guide-action" text="User Guide" icon="information" text-enabled></calcite-action>
        </calcite-action-group>
        <calcite-action-group slot="bottom-actions">
          <calcite-action id="about-action" text="About" icon="information" text-enabled></calcite-action>
        </calcite-action-group>
      </calcite-action-bar>

      <!-- MAIN PANEL CONTROLS-->
      <calcite-panel heading="Configure" id="panel-start">

        <!-- place dropdown -->
        <calcite-block heading="Place" description="Select a UGB" icon-start="h3-hexagon" expanded>
          <calcite-combobox id="place-combobox" placeholder="Select a UGB" selection-mode="single">
          </calcite-combobox>
        </calcite-block>

        <!-- indicators dropdown -->
        <calcite-block collapsible heading="Indicators" description="Select Harms & Assets" icon-start="effects"
          expanded>
          <calcite-combobox id="indicator-combobox" placeholder="Indicators" selection-mode="multiple"
            selected-items-label="single" style="z-index: 1000;">
            <calcite-combobox-item-group label="Assets"></calcite-combobox-item-group>
            <calcite-combobox-item-group label="Harms"></calcite-combobox-item-group>
          </calcite-combobox>
        </calcite-block>

        <!-- screeners selection-->
        <calcite-block collapsible heading="Screeners" description="Select Screener Overlays" icon-start="map-pin"
          expanded>
          <div id="layer-controls">
            <label><input type="checkbox" id="tsunami_zone" unchecked> Tsunami Zone</label><br>
            <label><input type="checkbox" id="highway" unchecked> Highway</label><br>
            <label><input type="checkbox" id="electric_transmission_lines" unchecked> Electric Transmission
              Lines</label>
          </div>
        </calcite-block>

        <!-- comparison region selection-->
        <calcite-block collapsible heading="Comparison" description="Select Comparison Region" icon-start="compare"
          expanded>
          <div id="comparison-region">
            <calcite-radio-button-group name="Options" layout="horizontal">
              <calcite-label layout="inline">
                <calcite-radio-button value="ugb_pct_rank" checked></calcite-radio-button>
                UGB
              </calcite-label>
              <calcite-label layout="inline">
                <calcite-radio-button value="region_pct_rank"></calcite-radio-button>
                Region
              </calcite-label>
              <calcite-label layout="inline">
                <calcite-radio-button value="st_pct_rank"></calcite-radio-button>
                State
              </calcite-label>
            </calcite-radio-button-group>
          </div>
        </calcite-block>

      </calcite-panel>
    </calcite-shell-panel>


    <!-- MAIN CONTENT (MAP) -->
    <calcite-panel>
      <arcgis-map basemap="gray-vector" center="-120.70, 44.12" zoom="6">
        <arcgis-zoom position="top-right"></arcgis-zoom>
      </arcgis-map>
    </calcite-panel>
  </calcite-shell>

  <!-- CUSTOM LEGEND TO INJECT INTO MAP UI-->
  <div id="legend-container" style="background:white; padding:20px; z-index:100; display: none">


    <!-- Grid Container -->
    <div style="display:grid; 
              grid-template-columns: 50px repeat(4, 50px); 
              grid-template-rows: repeat(4, 50px) 20px; 
              gap:2px; 
              position:relative;">

      <!-- Y axis label -->
      <div
        style="position:absolute; left:5px; top:50px; writing-mode: vertical-rl; font-weight:bold; text-align:center;">
        ← Higher Assets
      </div>

      <!-- Percentage labels y direction -->
      <div
        style="grid-row:1; grid-column:1; writing-mode: vertical-rl; text-align:center; font-size:10px; align-self:center;">
        75-100%</div>
      <div
        style="grid-row:2; grid-column:1; writing-mode: vertical-rl; text-align:center; font-size:10px; align-self:center;">
        50-75%</div>
      <div
        style="grid-row:3; grid-column:1; writing-mode: vertical-rl; text-align:center; font-size:10px; align-self:center;">
        25-50%</div>
      <div
        style="grid-row:4; grid-column:1; writing-mode: vertical-rl; text-align:center; font-size:10px; align-self:center;">
        0-25%</div>

      <!-- Color matrix cells -->
      <!-- Rows are reversed from how they are represented in the renderer strings.. 4 = 1-->
      <!-- Row 1 -->
      <div id="4,1" style="grid-row:1; grid-column:2; background:#169dd0;"></div>
      <div id="4,2" style="grid-row:1; grid-column:3; background:#16869e;"></div>
      <div id="4,3" style="grid-row:1; grid-column:4; background:#166d68;"></div>
      <div id="4,4" style="grid-row:1; grid-column:5; background:#174f28;"></div>

      <!-- Row 2 -->
      <div id="3,1" style="grid-row:2; grid-column:2; background:#5fb2d1;"></div>
      <div id="3,2" style="grid-row:2; grid-column:3; background:#60979f;"></div>
      <div id="3,3" style="grid-row:2; grid-column:4; background:#617b69;"></div>
      <div id="3,4" style="grid-row:2; grid-column:5; background:#635929;"></div>

      <!-- Row 3 -->
      <div id="2,1" style="grid-row:3; grid-column:2; background:#9cc4d2;"></div>
      <div id="2,2" style="grid-row:3; grid-column:3; background:#9ea69f;"></div>
      <div id="2,3" style="grid-row:3; grid-column:4; background:#a08769;"></div>
      <div id="2,4" style="grid-row:3; grid-column:5; background:#a36229;"></div>

      <!-- Row 4 -->
      <div id="1,1" style="grid-row:4; grid-column:2; background:#d3d3d3;"></div>
      <div id="1,2" style="grid-row:4; grid-column:3; background:#d6b3a0;"></div>
      <div id="1,3" style="grid-row:4; grid-column:4; background:#d9926a;"></div>
      <div id="1,4" style="grid-row:4; grid-column:5; background:#dd6a29;"></div>

      <!-- Percentage labels x direction -->
      <div style="grid-row:5; grid-column:2; text-align:center; font-size:10px;">0-25%</div>
      <div style="grid-row:5; grid-column:3; text-align:center; font-size:10px;">25-50%</div>
      <div style="grid-row:5; grid-column:4; text-align:center; font-size:10px;">50-75%</div>
      <div style="grid-row:5; grid-column:5; text-align:center; font-size:10px;">75-100%</div>

      <!-- Large X Axis Label -->
      <div style="grid-row:6; grid-column:2/6; text-align:center; font-weight:bold;">
        Higher Harms →
      </div>

    </div>
  </div>



  <div id="hover-tooltip"></div>
  <script type="module" src="./src/main.js"></script>
</body>

</html>
